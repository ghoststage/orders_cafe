{% extends 'base.html' %}
{% block content %}
<div class="container">
    <h2>–°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤</h2>

    <form method="GET" action="{% url 'order_list' %}" class="filter-form">
        <label for="status">–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É:</label>
        <select name="status" id="status" onchange="this.form.submit()">
            <option value="">–í—Å–µ</option>
            <option value="pending" {% if request.GET.status == "pending" %}selected{% endif %}>–í –æ–∂–∏–¥–∞–Ω–∏–∏</option>
            <option value="ready" {% if request.GET.status == "ready" %}selected{% endif %}>–ì–æ—Ç–æ–≤–æ</option>
            <option value="paid" {% if request.GET.status == "paid" %}selected{% endif %}>–û–ø–ª–∞—á–µ–Ω–æ</option>
        </select>
    </form>

    <form method="GET" action="{% url 'search_orders' %}" class="search-form">
        <input type="text" name="query" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É —Å—Ç–æ–ª–∞ –∏–ª–∏ —Å—Ç–∞—Ç—É—Å—É...">
        <button type="submit">üîç –ù–∞–π—Ç–∏</button>
    </form>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>–ù–æ–º–µ—Ä —Å—Ç–æ–ª–∞</th>
                <th>–ë–ª—é–¥–∞</th>
                <th>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>{{ order.id }}</td>
                <td>{{ order.table_number }}</td>
                <td>
                    <ul>
                        {% for item in order.items.all %}
                        <li>{{ item.name }} - {{ item.price }} —Ç–Ω–≥.</li>
                        {% endfor %}
                    </ul>
                </td>
                <td><strong>{{ order.total_price }} —Ç–Ω–≥.</strong></td>
                <td>
                    <span class="status {% if order.status == 'pending' %}pending{% elif order.status == 'ready' %}ready{% else %}paid{% endif %}">
                        {{ order.get_status_display }}
                    </span>
                </td>
                <td class="actions">
                    <div class="btn-group">
                        <a href="{% url 'update_status' order.id 'ready' %}" class="btn ready">–ì–æ—Ç–æ–≤</a>
                        <a href="{% url 'update_status' order.id 'paid' %}" class="btn paid">–û–ø–ª–∞—á–µ–Ω</a>
                        <a href="{% url 'edit_order' order.id %}" class="btn edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="{% url 'delete_order' order.id %}" class="btn delete">–£–¥–∞–ª–∏—Ç—å</a>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6">–ó–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="add-order-btn">
        <a href="{% url 'add_order' %}" class="btn add-order">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</a>
    </div>

    <h3>–ú–µ–Ω—é:</h3>
    <ul>
        {% for dish in dishes %}
        <li>{{ dish.name }} - {{ dish.price }} —Ç–Ω–≥.</li>
        {% endfor %}
    </ul>

    <div class="revenue-link">
        <a href="{% url 'calculate_revenue' %}" class="btn revenue">–í—ã—Ä—É—á–∫–∞</a>
    </div>
</div>
{% endblock %}
